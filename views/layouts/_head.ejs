<title><%- defineContent('title') ? defineContent('title') : 'LMS' %></title>

<link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
/>
<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
/>
<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/css/select2.min.css"
/>

<link rel="stylesheet" href="/style/main.css"/>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.30.1/moment.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.1.0-beta.1/js/select2.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<link
    rel="stylesheet"
    href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.min.css"
/>
<script src="https://cdn.datatables.net/2.0.8/js/dataTables.min.js"></script>

<style>
    body {
        display: flex;
        margin: 0;
    }
</style>
<script>
    $.ajaxSetup({
        headers: {
            'Authorization': `Bearer ${localStorage.getItem('token')}`,
        },
        dataType: 'json',
    })
    $.ajaxPrefilter('json', (options, originalOptions) => {
        if (originalOptions.data) {
            options.data = JSON.stringify(originalOptions.data)
        }
        options.contentType = 'application/json'
    })
    
    /*
     ** Funtion
     */
    $.getUrlParameter = (pathname) => {
        const pattern = new URLPattern({ pathname })
        return pattern.exec(window.location.href).pathname.groups
    }
    $.getFormData = form => {
        const data = $(`${form} [name]`)
            .toArray()
            .reduce(
                (result, elem) => {
                    elem = $(elem)
                    return {
                        ...result,
                        [elem.prop('name')]: elem.val(),
                    }
                },
                {}
            )
        console.log('getFormData', data)
        return data
    }
    $.setFormData = (formName, data = {}) => {
        const form = $(formName)
        let debug = []
        for (const key in data) {
            const elem = form.find(`[name=${key}]`)
            if (elem.length <= 0) continue
            let value = data[key]
            elem.val(typeof value === 'function' ? value(elem) : value)
            debug.push({ elem, key, value })
        }
        console.log('setFormData', debug)
    }
    $.cloneTemplate = (selector, data = {}, options = {}) => {
        const { insert = true } = options
        let elem = $(selector).clone().html()
        for (const key in data) {
            elem = elem.replaceAll(`\${${key}}`, data[key])
        }
        if (insert) {
            $(selector).before(elem)
        } else {
            return $(elem)
        }
    }
</script>
